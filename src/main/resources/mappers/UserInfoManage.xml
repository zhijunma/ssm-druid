<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.cn.school.mapper.mzj.UserInfoManageMapper">
    <!--更新用户信息-->
    <update id="updateUserInfo">
        update user_info
        set
        <if test="ds.userName != null and '' != ds.userName">
            user_name=#{ds.userName},
        </if>
        <if test="ds.qq != null and '' != ds.qq">
            qq=#{ds.qq},
        </if>
        <if test="ds.email != null and '' != ds.email">
            email=#{ds.email},
        </if>
        <if test="ds.address != null and '' != ds.address">
            address=#{ds.address},
        </if>
        <if test="ds.mobilePhone != null and '' != ds.mobilePhone">
            mobile_phone=#{ds.mobilePhone},
        </if>
        <if test="ds.sex != null and '' != ds.sex">
            sex=#{ds.sex},
        </if>
        <if test="ds.userRole != null and '' != ds.userRole">
            user_role=#{ds.userRole},
        </if>
        <if test="ds.userPassword != null and '' != ds.userPassword">
            user_password=#{ds.userPassword},
        </if>
        where
        delete_flag = 0
        and user_id = #{ds.userId}
    </update>
    <!--删除用户（假删除）-->
    <update id="deleteUser">
        update user_info
        set delete_flag = 1
        where delete_flag = 0
        and user_id in
        <foreach collection="list" open="(" close=")" separator="," item="item">
            #{item}
        </foreach>
    </update>
    <!--通过mobile_phone查找用户信息-->
    <select id="getUserInfoByItem" resultType="com.cn.school.entity.mzj.DSUserInfo">
        select
        user_id as userId,
        user_name as userName,
        qq,
        sex,
        email,
        address,
        mobile_phone as mobilePhone
        from user_info
        where delete_flag = 0
        <if test="ds.userId != null and '' != ds.userId">
            and user_id=#{ds.userId}
        </if>
        <if test="ds.mobilePhone != null and '' != ds.mobilePhone">
            and mobile_phone=#{ds.mobilePhone}
        </if>
        <if test="ds.address != null and '' != ds.address">
            and user_id=#{ds.userId}
        </if>
        <if test="ds.userName != null and '' != ds.userName">
            and user_name like concat('%',#{ds.userName},'%')
        </if>
        <if test="ds.sex != null and '' != ds.sex">
            and sex=#{ds.sex}
        </if>
        <if test="ds.userRole != null and '' != ds.userRole">
            and user_role=#{ds.userRole}
        </if>
        <if test="ds.qq != null and '' != ds.qq">
            and qq=#{ds.qq}
        </if>
    </select>
    <!--查看所有用户-->
    <select id="getAllUsers" resultType="com.cn.school.entity.mzj.DSUserInfo">
        select
        user_id as userId,
        user_name as userName,
        user_password as userPassword,
        qq,
        sex,
        email,
        address,
        mobile_phone as mobilePhone,
        add_time as addTime,
        delete_flag as deleteFlag
        from user_info
        where delete_flag = 0
    </select>
    <!--删除用户-->

</mapper>